<!-- eslint-disable vue/no-parsing-error -->
<template>
  <img :src="bg14" alt="slide" />

  <svg
    width="1920"
    viewBox="0 0 1920 1080"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <g>
      <g id="further-btn">
        <rect x="618" y="921" width="685" height="69" rx="20" fill="white" />
        <text
          fill="#010101"
          xml:space="preserve"
          style="white-space: pre"
          font-family="Gogh"
          font-size="22"
          font-weight="500"
          letter-spacing="0em"
        >
          <tspan x="855.971" y="962.977">
            &#x41f;&#x440;&#x43e;&#x434;&#x43e;&#x43b;&#x436;&#x438;&#x442;&#x44c;
          </tspan>
        </text>
        <g id="Group 528">
          <rect
            id="Rectangle 197"
            x="1015.97"
            y="954.5"
            width="42"
            height="2"
            fill="#010101"
          />
          <path
            id="Polygon 2"
            d="M1065.03 955.5L1050.78 962.428L1055.47 955.5L1050.78 948.572L1065.03 955.5Z"
            fill="#010101"
          />
        </g>
      </g>
      <g id="text-1">
        <g id="Frame 102">
          <path
            d="M467 365C467 356.163 474.163 349 483 349H1248V466C1248 474.837 1240.84 482 1232 482H483C474.163 482 467 474.837 467 466V365Z"
            fill="white"
          />
          <text
            id="value"
            fill="black"
            xml:space="preserve"
            style="white-space: pre"
            font-family="Gogh"
            font-size="22"
            font-weight="500"
            letter-spacing="0em"
          >
            <tspan x="512" y="400.977">
              &#x41d;&#x430;&#x43f;&#x43e;&#x43c;&#x438;&#x43d;&#x430;&#x44e;,
              &#x43d;&#x430;&#x441;&#x442;&#x43e;&#x44f;&#x449;&#x438;&#x439;
              &#x43f;&#x440;&#x43e;&#x433;&#x440;&#x430;&#x43c;&#x43c;&#x438;&#x441;&#x442;-&#x440;&#x430;&#x437;&#x440;&#x430;&#x431;&#x43e;&#x442;&#x447;&#x438;&#x43a;
              &#x43c;&#x43e;&#x436;&#x435;&#x442;
            </tspan>
            <tspan x="512" y="429.977">
              &#x440;&#x430;&#x431;&#x43e;&#x442;&#x430;&#x442;&#x44c;
              &#x442;&#x43e;&#x43b;&#x44c;&#x43a;&#x43e; &#x43d;&#x430;
              &#x41f;&#x41a; &#x438;&#x43b;&#x438;
              &#x43d;&#x43e;&#x443;&#x442;&#x431;&#x443;&#x43a;&#x435;.
            </tspan>
          </text>
        </g>
        <path
          id="Vector 17"
          d="M1247 349H1267L1248.71 367.293L1247 369V366.586V349Z"
          fill="white"
        />
      </g>
      <g id="text-2">
        <g id="Frame 102_2">
          <path
            d="M353 230C353 221.163 360.163 214 369 214H1118C1126.84 214 1134 221.163 1134 230V376H369C360.163 376 353 368.837 353 360V230Z"
            fill="white"
          />
          <text
            id="value_2"
            fill="black"
            xml:space="preserve"
            style="white-space: pre"
            font-family="Gogh"
            font-size="22"
            font-weight="500"
            letter-spacing="0em"
          >
            <tspan x="398" y="265.977">
              &#x421;&#x435;&#x439;&#x447;&#x430;&#x441; &#x442;&#x44b;
              &#x43f;&#x43e;&#x437;&#x43d;&#x430;&#x43a;&#x43e;&#x43c;&#x438;&#x448;&#x44c;&#x441;&#x44f;
              &#x441;
              &#x41a;&#x43e;&#x43d;&#x444;&#x438;&#x433;&#x443;&#x440;&#x430;&#x442;&#x43e;&#x440;&#x43e;&#x43c;
              1&#x421; &#x2013; &#x44d;&#x442;&#x43e;
            </tspan>
            <tspan x="398" y="294.977">
              &#x43e;&#x441;&#x43d;&#x43e;&#x432;&#x43d;&#x430;&#x44f;
              &#x441;&#x440;&#x435;&#x434;&#x430;
              &#x440;&#x430;&#x437;&#x440;&#x430;&#x431;&#x43e;&#x442;&#x43a;&#x438;.
              &#x412; &#x43d;&#x435;&#x439;
              &#x43f;&#x440;&#x43e;&#x438;&#x441;&#x445;&#x43e;&#x434;&#x438;&#x442;
              &#x43d;&#x430;&#x43f;&#x438;&#x441;&#x430;&#x43d;&#x438;&#x435;
            </tspan>
            <tspan x="398" y="323.977">
              &#x43a;&#x43e;&#x434;&#x430; &#x438; &#x432;&#x441;&#x44f;
              &#x43c;&#x430;&#x433;&#x438;&#x44f;!
            </tspan>
          </text>
        </g>
        <path
          id="Vector 17_2"
          d="M1133 376V356L1151.29 374.293L1153 376H1150.59H1133Z"
          fill="white"
        />
      </g>
      <g id="text-3">
        <g id="Frame 102_3">
          <path
            d="M423 284C423 275.163 430.163 268 439 268H1188C1196.84 268 1204 275.163 1204 284V401H439C430.163 401 423 393.837 423 385V284Z"
            fill="white"
          />
          <text
            id="value_3"
            fill="black"
            xml:space="preserve"
            style="white-space: pre"
            font-family="Gogh"
            font-size="22"
            font-weight="500"
            letter-spacing="0em"
          >
            <tspan x="468" y="319.977">
              &#x417;&#x430; &#x43a;&#x430;&#x436;&#x434;&#x43e;&#x435;
              &#x432;&#x44b;&#x43f;&#x43e;&#x43b;&#x43d;&#x435;&#x43d;&#x43d;&#x43e;&#x435;
              &#x437;&#x430;&#x434;&#x430;&#x43d;&#x438;&#x435; &#x442;&#x44b;
              &#x431;&#x443;&#x434;&#x435;&#x448;&#x44c;
              &#x43f;&#x43e;&#x43b;&#x443;&#x447;&#x430;&#x442;&#x44c;
              &#x43e;&#x43f;&#x43b;&#x430;&#x442;&#x443;.
            </tspan>
            <tspan x="468" y="348.977">
              &#x421;&#x443;&#x43c;&#x43c;&#x430;
              &#x442;&#x432;&#x43e;&#x435;&#x433;&#x43e;
              &#x437;&#x430;&#x440;&#x430;&#x431;&#x43e;&#x442;&#x43a;&#x430;
              &#x431;&#x443;&#x434;&#x435;&#x442;
              &#x43e;&#x442;&#x43e;&#x431;&#x440;&#x430;&#x436;&#x430;&#x442;&#x44c;&#x441;&#x44f;
              &#x437;&#x434;&#x435;&#x441;&#x44c;.
            </tspan>
          </text>
        </g>
        <path
          id="Vector 17_3"
          d="M1203 401V381L1221.29 399.293L1223 401H1220.59H1203Z"
          fill="white"
        />
      </g>
      <g id="text-4">
        <g id="Frame 102_4">
          <path
            d="M425 212C425 203.163 432.163 196 441 196H1190C1198.84 196 1206 203.163 1206 212V329H441C432.163 329 425 321.837 425 313V212Z"
            fill="white"
          />
          <text
            id="value_4"
            fill="black"
            xml:space="preserve"
            style="white-space: pre"
            font-family="Gogh"
            font-size="22"
            font-weight="500"
            letter-spacing="0em"
          >
            <tspan x="470" y="247.977">
              &#x41a;&#x430;&#x43a; &#x431;&#x443;&#x434;&#x435;&#x442;
              &#x443;&#x434;&#x43e;&#x431;&#x43d;&#x43e;,
              &#x43f;&#x440;&#x438;&#x441;&#x442;&#x443;&#x43f;&#x430;&#x439;
              &#x43a; &#x437;&#x430;&#x434;&#x430;&#x43d;&#x438;&#x44f;&#x43c;.
              &#x41e;&#x43d;&#x438; &#x437;&#x430;&#x439;&#x43c;&#x443;&#x442;
              &#x443; &#x442;&#x435;&#x431;&#x44f; &#x43d;&#x435;
            </tspan>
            <tspan x="470" y="276.977">
              &#x431;&#x43e;&#x43b;&#x435;&#x435; 20
              &#x43c;&#x438;&#x43d;&#x443;&#x442;!
            </tspan>
          </text>
        </g>
        <path
          id="Vector 17_4"
          d="M1205 329V309L1223.29 327.293L1225 329H1222.59H1205Z"
          fill="white"
        />
      </g>
      <g id="text-5">
        <g id="Frame 102_5">
          <path
            d="M425 365C425 356.163 432.163 349 441 349H1206V495C1206 503.837 1198.84 511 1190 511H441C432.163 511 425 503.837 425 495V365Z"
            fill="white"
          />
          <text
            id="value_5"
            fill="black"
            xml:space="preserve"
            style="white-space: pre"
            font-family="Gogh"
            font-size="22"
            font-weight="500"
            letter-spacing="0em"
          >
            <tspan x="470" y="400.977">
              &#x418; &#x43f;&#x43e;&#x43c;&#x43d;&#x438;,
              &#x43b;&#x443;&#x447;&#x448;&#x438;&#x435;
              &#x43f;&#x440;&#x43e;&#x433;&#x440;&#x430;&#x43c;&#x43c;&#x438;&#x441;&#x442;&#x44b;
              &#x2013; &#x44d;&#x442;&#x43e; &#x442;&#x435;,
              &#x43a;&#x442;&#x43e;
              &#x43a;&#x430;&#x447;&#x435;&#x441;&#x442;&#x432;&#x435;&#x43d;&#x43d;&#x43e;
            </tspan>
            <tspan x="470" y="429.977">
              &#x432;&#x44b;&#x43f;&#x43e;&#x43b;&#x43d;&#x44f;&#x44e;&#x442;
              &#x437;&#x430;&#x434;&#x430;&#x447;&#x438; &#x432;
              &#x43a;&#x440;&#x430;&#x442;&#x447;&#x430;&#x439;&#x448;&#x438;&#x435;
              &#x441;&#x440;&#x43e;&#x43a;&#x438;.
              &#x41f;&#x43e;&#x44d;&#x442;&#x43e;&#x43c;&#x443;
              &#x447;&#x435;&#x43c;
            </tspan>
            <tspan x="470" y="458.977">
              &#x431;&#x44b;&#x441;&#x442;&#x440;&#x435;&#x435;
              &#x441;&#x43f;&#x440;&#x430;&#x432;&#x438;&#x448;&#x44c;&#x441;&#x44f;
              &#x441;
              &#x437;&#x430;&#x434;&#x430;&#x43d;&#x438;&#x44f;&#x43c;&#x438;,
              &#x442;&#x435;&#x43c; &#x431;&#x43e;&#x43b;&#x44c;&#x448;&#x435;
              &#x437;&#x430;&#x440;&#x430;&#x431;&#x43e;&#x442;&#x430;&#x435;&#x448;&#x44c;!
            </tspan>
          </text>
        </g>
        <path
          id="Vector 17_5"
          d="M1205 349H1225L1206.71 367.293L1205 369V366.586V349Z"
          fill="white"
        />
      </g>
    </g>
  </svg>
</template>

<script setup>
import { nextTick, onBeforeUnmount, onMounted, ref, watch } from "vue";
// import { useUserStore } from '@/store/user'
// import { storeToRefs } from 'pinia'
import bg14 from "@/assets/slides-images/fourteen/bg.webp";
import useFurtherButton from "../../composables/useFurtherButton";
import vitaly from "./assets/vitaly.mp3";
import vitaly2 from "./assets/vitaly2.mp3";
import vitaly3 from "./assets/vitaly3.mp3";
import vitaly4 from "./assets/vitaly4.mp3";
import vitaly5 from "./assets/vitaly5.mp3";

const audioVitaly1 = new Audio(vitaly);
const audioVitaly2 = new Audio(vitaly2);
const audioVitaly3 = new Audio(vitaly3);
const audioVitaly4 = new Audio(vitaly4);
const audioVitaly5 = new Audio(vitaly5);
// eslint-disable-next-line no-undef
const emit = defineEmits(["continue", "question", "showCashCounter"]);
useFurtherButton();
// const user = useUserStore()
// const { userName } = storeToRefs(user)
const replicStepAskWaiting = ref(true);

const nextStep = () => {
  replicStepAskWaiting.value = false;
  replicStep.value += 1;
};

let text1, text2, text3, text4, text5;

const replicStep = ref(0);

watch(replicStep, (value) => {
  switch (value) {
    case 1:
      audioVitaly1.pause();
      text1.classList.remove("visible");
      audioVitaly2.play();
      text2.classList.add("visible");
      break;

    case 2:
      audioVitaly2.pause();
      text2.classList.remove("visible");
      audioVitaly3.play();
      text3.classList.add("visible");
      setTimeout(() => {
        emit("showCashCounter");
      }, 500);
      break;

    case 3:
      audioVitaly3.pause();
      text3.classList.remove("visible");
      audioVitaly4.play();
      text4.classList.add("visible");
      break;

    case 4:
      audioVitaly4.pause();
      audioVitaly5.play();
      text5.classList.add("visible");
      setTimeout(() => {
        emit("continue");
      }, 500);
      break;
    default:
      break;
  }
});

onMounted(async () => {
  await nextTick();

  document.addEventListener("nextReplic", () => {
    if (replicStepAskWaiting.value === true) return;
    replicStep.value += 1;
  });

  text1 = document.querySelector("#text-1");
  text2 = document.querySelector("#text-2");
  text3 = document.querySelector("#text-3");
  text4 = document.querySelector("#text-4");
  text5 = document.querySelector("#text-5");

  setTimeout(() => {
    text1.classList.add("visible");
    audioVitaly1.play();
  }, 500);

  setTimeout(() => {
    emit("question");
  }, 1500);
});

onBeforeUnmount(() => {
  audioVitaly5.pause();
});

// eslint-disable-next-line no-undef
defineExpose({
  nextStep,
});
</script>

<style lang="scss"></style>
